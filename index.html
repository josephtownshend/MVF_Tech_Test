<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Favourite langauge</title>
  </head>
  <body>

    <form id="name-form">
      <p>
        <label>Enter your GitHub username</label><br>
        <input type="text" name="fullName">
      </p>
      <p>
        <input type="submit" value="Submit">
      </p>
    </form>
    <p id ="result"></p>
    <p id ="faveLanguage"></p>

    <script>

      let form = document.getElementById('name-form');
      form.onsubmit = function(event) {
        event.preventDefault();
        let result = document.getElementById('result');
        result.innerHTML = form.fullName.value;

        // this.reset();
        let name = form.fullName.value
        console.log(name)

            const url = 'https://api.github.com/users/'+name+'/repos';

            fetch(url)
            .then((response) => response.json())
            .then(function(data) {
            const primaryLanguages = data.map(function(language) {
              return language.language;
            })
            // console.log(primaryLanguages)

            function countLanguages(language, count) {
              language[count] = (++language[count] || 1);
              return language;
            }

            const primaryLanguageCount = primaryLanguages.reduce(countLanguages, {});
            console.log(primaryLanguageCount);

            let arrCount = Object.values(primaryLanguageCount);

            let largestCount = Math.max.apply(Math, arrCount);

            for (let value in primaryLanguageCount) {
              let key = primaryLanguageCount[value];
                if (key == largestCount)
                console.log(value);

                let faveLanguage = document.getElementById('faveLanguage');
                faveLanguage.innerHTML = value;
              }
      });
    };

    </script>
  </body>
</html>
